{% extends 'wafer/base_form.html' %}
{% load i18n %}
{% load crispy_forms_tags %}
{% load static from staticfiles %}
{% block extra_head %}
{{ block.super }}
   <script type="text/javascript" language="Javascript">
      function updateTotal() {
        var total = 0;
         console.log('here');
        items =  document.getElementsByClassName("budget");
        target = document.getElementsByClassName("budget_total");
         console.log(items);
         console.log(target);
        for (var i=0;i<items.length;i++) {
            var val = parseFloat(items[i].value,10);
           console.log(items[i]);
           console.log(val);
            total+=(isNaN(val))?0:val;
        }
        target[0].innerHTML = "R " + String(total);
         console.log(target);
         console.log(total);
         return total;
      }

      function updateRequestedTotal() {
         var requested = 0;
        items =  document.getElementsByClassName("request");
        target = document.getElementsByClassName("request_total");
      }
   </script>
{% endblock %}
{% block content %}
<section class="wafer wafer-funding-edit">
  {% if can_edit %}
    <h1>{% trans "Update Application" %}</h1>
    {% with application_name=object.applicant.userprofile.display_name %}
      {% url 'wafer_user_profile' username=object.applicant.username as applicant_url %}
      {% blocktrans %}
        <p>Submitted by <a href="{{ applicant_url }}">{{ applicant_name }}</a>.</p>
      {% endblocktrans %}
    {% endwith %}
  {% else %}
    <h1>{% trans "Funding Application Submission" %}</h1>
  {% endif %}
  {% if not can_edit and not can_submit %}
    {% blocktrans %}
      <em>Funding Application submission is closed</em>
    {% endblocktrans %}
  {% else %}
    {% crispy form %}
  {% endif %}
</section>
{% endblock %}
{% block extra_foot %}
{{ block.super }}
<script type="text/javascript" src="{% static 'js/markitup.js' %}"></script>
{% endblock %}
